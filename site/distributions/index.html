<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Probability Distributions - FFA Framework</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Probability Distributions";
        var mkdocs_page_input_path = "distributions.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> FFA Framework
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">R Package</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../r-documentation.pdf">Documentation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Command Line Interface</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cli-installation/">Installation Instructions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cli-manual/">User Manual</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Concepts</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../eda/">Exploratory Data Analysis</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Probability Distributions</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#list-of-distributions">List of Distributions</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#gumbel-gum-distribution">Gumbel (GUM) Distribution</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#normal-nor-distribution">Normal (NOR) Distribution</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#log-normal-lno-distribution">Log-Normal (LNO) Distribution</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#generalized-extreme-value-gev-distribution">Generalized Extreme Value (GEV) Distribution</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#generalized-logistic-glo-distribution">Generalized Logistic (GLO) Distribution</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#generalized-normal-gno-distribution">Generalized Normal (GNO) Distribution</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#pearson-type-iii-pe3-distribution">Pearson Type III (PE3) Distribution</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#log-pearson-type-iii-lp3-distribution">Log-Pearson Type III (LP3) Distribution</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#weibull-wei-distribution">Weibull (WEI) Distribution</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#kappa-kap-distribution">Kappa (KAP) Distribution</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#sources">Sources</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../model-selection/">Model Selection</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../parameter-estimation/">Parameter Estimation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../frequency-analysis/">Frequency Analysis</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../uncertainty-quantification/">Uncertainty Quantification</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../model-assessment/">Model Assessment</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../goals/">Goals</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../roadmap/">Roadmap</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../changelog/">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../matlab/">MATLAB Version</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../license/">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">FFA Framework</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Concepts</li>
      <li class="breadcrumb-item active">Probability Distributions</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="probability-distributions">Probability Distributions</h1>
<p>The FFA framework uses the <span class="arithmatex">\(9\)</span> probability distributions listed below:</p>
<table>
<thead>
<tr>
<th>Distribution</th>
<th>Abbreviation</th>
<th>Parameters</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gumbel</td>
<td><code>GUM</code></td>
<td><span class="arithmatex">\(\mu\)</span> (location), <span class="arithmatex">\(\sigma\)</span> (scale)</td>
</tr>
<tr>
<td>Normal</td>
<td><code>NOR</code></td>
<td><span class="arithmatex">\(\mu\)</span> (location), <span class="arithmatex">\(\sigma\)</span> (scale)</td>
</tr>
<tr>
<td>Log-Normal</td>
<td><code>LNO</code></td>
<td><span class="arithmatex">\(\mu\)</span> (location), <span class="arithmatex">\(\sigma\)</span> (scale)</td>
</tr>
<tr>
<td>Generalized Extreme Value</td>
<td><code>GEV</code></td>
<td><span class="arithmatex">\(\mu\)</span> (location), <span class="arithmatex">\(\sigma\)</span> (scale), <span class="arithmatex">\(\kappa\)</span> (shape)</td>
</tr>
<tr>
<td>Generalized Logistic Value</td>
<td><code>GLO</code></td>
<td><span class="arithmatex">\(\mu\)</span> (location), <span class="arithmatex">\(\sigma\)</span> (scale), <span class="arithmatex">\(\kappa\)</span> (shape)</td>
</tr>
<tr>
<td>Generalized Normal</td>
<td><code>GNO</code></td>
<td><span class="arithmatex">\(\mu\)</span> (location), <span class="arithmatex">\(\sigma\)</span> (scale), <span class="arithmatex">\(\kappa\)</span> (shape)</td>
</tr>
<tr>
<td>Pearson Type III</td>
<td><code>PE3</code></td>
<td><span class="arithmatex">\(\mu\)</span> (location), <span class="arithmatex">\(\sigma\)</span> (scale), <span class="arithmatex">\(\kappa\)</span> (shape)</td>
</tr>
<tr>
<td>Log-Pearson Type III</td>
<td><code>LP3</code></td>
<td><span class="arithmatex">\(\mu\)</span> (location), <span class="arithmatex">\(\sigma\)</span> (scale), <span class="arithmatex">\(\kappa\)</span> (shape)</td>
</tr>
<tr>
<td>Weibull</td>
<td><code>WEI</code></td>
<td><span class="arithmatex">\(\mu\)</span> (location), <span class="arithmatex">\(\sigma\)</span> (scale), <span class="arithmatex">\(\kappa\)</span> (shape)</td>
</tr>
</tbody>
</table>
<p>Each distribution also has two non-stationary variants which we denote by adding a "signature" to the model abbreviation.
For two-parameter distributions (<code>GUM</code>, <code>NOR</code>, <code>LNO</code>):</p>
<ol>
<li><code>XXX</code> is the standard, stationary model.</li>
<li><code>XXX10</code> has a trend in the location parameter <span class="arithmatex">\(\mu\)</span>.</li>
<li><code>XXX01</code> has a trend in the scale parameter <span class="arithmatex">\(\sigma\)</span>.</li>
<li><code>XXX11</code> has a trend in the location <span class="arithmatex">\(\mu\)</span> and the scale <span class="arithmatex">\(\sigma\)</span>.</li>
</ol>
<p>Shown below is a table summarizing these three models:</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th><code>XXX</code></th>
<th><code>XXX10</code></th>
<th><code>XXX01</code></th>
<th><code>XXX11</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>Location <span class="arithmatex">\(\mu\)</span></td>
<td><span class="arithmatex">\(\mu\)</span> (constant)</td>
<td><span class="arithmatex">\(\mu_0 + \mu_1z\)</span></td>
<td><span class="arithmatex">\(\mu\)</span> (constant)</td>
<td><span class="arithmatex">\(\mu_0 + \mu_1z\)</span></td>
</tr>
<tr>
<td>Scale <span class="arithmatex">\(\sigma\)</span></td>
<td><span class="arithmatex">\(\sigma\)</span> (constant)</td>
<td><span class="arithmatex">\(\sigma\)</span> (constant)</td>
<td><span class="arithmatex">\(\sigma_0 + \sigma_1z\)</span></td>
<td><span class="arithmatex">\(\sigma_0 + \sigma_1z\)</span></td>
</tr>
<tr>
<td>Number of Parameters</td>
<td>2</td>
<td>3</td>
<td>3</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>For three-parameter distributions (<code>GEV</code>, <code>GLO</code>, <code>GNO</code>, <code>PE3</code>, <code>LP3</code>, <code>WEI</code>):</p>
<ol>
<li><code>XXX</code> is the standard, stationary model.</li>
<li><code>XXX100</code> has a trend in the location parameter <span class="arithmatex">\(\mu\)</span>.</li>
<li><code>XXX010</code> has a trend in the scale parameter <span class="arithmatex">\(\sigma\)</span>.</li>
<li><code>XXX110</code> has a trend in the location <span class="arithmatex">\(\mu\)</span> and the scale <span class="arithmatex">\(\sigma\)</span>.</li>
</ol>
<p>Shown below is a table summarizing these three models:</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th><code>XXX</code></th>
<th><code>XXX100</code></th>
<th><code>XXX010</code></th>
<th><code>XXX110</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>Location <span class="arithmatex">\(\mu\)</span></td>
<td><span class="arithmatex">\(\mu\)</span> (constant)</td>
<td><span class="arithmatex">\(\mu_0 + \mu_1z\)</span></td>
<td><span class="arithmatex">\(\mu\)</span> (constant)</td>
<td><span class="arithmatex">\(\mu_0 + \mu_1z\)</span></td>
</tr>
<tr>
<td>Scale <span class="arithmatex">\(\sigma\)</span></td>
<td><span class="arithmatex">\(\sigma\)</span> (constant)</td>
<td><span class="arithmatex">\(\sigma\)</span> (constant)</td>
<td><span class="arithmatex">\(\sigma_0 + \sigma_1z\)</span></td>
<td><span class="arithmatex">\(\sigma_0 + \sigma_1z\)</span></td>
</tr>
<tr>
<td>Shape <span class="arithmatex">\(\kappa\)</span></td>
<td><span class="arithmatex">\(\kappa\)</span> (constant)</td>
<td><span class="arithmatex">\(\kappa\)</span> (constant)</td>
<td><span class="arithmatex">\(\kappa\)</span> (constant)</td>
<td><span class="arithmatex">\(\kappa\)</span> (constant)</td>
</tr>
<tr>
<td>Number of Parameters</td>
<td>3</td>
<td>4</td>
<td>4</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>The FFA framework also uses the four-parameter Kappa distribution (KAP) for the <a href="../model-selection/#z-statistic">Z-statistic</a> selection metric. The Kappa distribution generalizes the <span class="arithmatex">\(9\)</span> distributions listed above.</p>
<h2 id="list-of-distributions">List of Distributions<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></h2>
<h3 id="gumbel-gum-distribution">Gumbel (GUM) Distribution</h3>
<p><strong>Support</strong></p>
<p><span class="arithmatex">\(-\infty &lt; x &lt; \infty\)</span></p>
<p><strong>Quantiles</strong></p>
<p><span class="arithmatex">\(x(F) = \mu - \sigma \log (-\log F)\)</span></p>
<p><strong>Likelihood Function</strong></p>
<p>The probability density function (PDF) of the Gumbel distribution is given below:</p>
<div class="arithmatex">\[
f(x_{i} : \mu, \sigma) = \frac{1}{\sigma} \exp \left(-z_{i} - e^{-z_{i}}\right) , \quad
z_{i} = \frac{x_{i} - \mu}{\sigma }
\]</div>
<p>Therefore, the Log-likelihood function is defined as follows:</p>
<div class="arithmatex">\[
\ell(x:\mu, \sigma) = \sum_{i=1}^{n} \left[-\ln \sigma - z_{i} - e^{-z_{i}} \right]
\]</div>
<p><strong>L-Moments</strong></p>
<p>In the equations below, <span class="arithmatex">\(\gamma \approx 0.5772\)</span> is <a href="https://en.wikipedia.org/wiki/Euler%27s_constant">Euler's constant</a>.</p>
<ul>
<li><span class="arithmatex">\(\lambda_{1} = \mu + \sigma \gamma\)</span></li>
<li><span class="arithmatex">\(\lambda_{2} = \sigma \log 2\)</span></li>
<li><span class="arithmatex">\(\tau_{3} = \log(9/8)/\log 2 \approx 0.1699\)</span></li>
<li><span class="arithmatex">\(\tau_{4} = (16 \log 2 - 10\log 3) / \log 2 \approx 0.1504\)</span></li>
</ul>
<p>We can also express the parameters in terms of the L-moments:</p>
<ul>
<li><span class="arithmatex">\(\sigma = \lambda_{2} / \log 2\)</span></li>
<li><span class="arithmatex">\(\mu = \lambda_{1} - \sigma \gamma\)</span></li>
</ul>
<h3 id="normal-nor-distribution">Normal (NOR) Distribution</h3>
<p><strong>Support</strong></p>
<p><span class="arithmatex">\(-\infty &lt; x &lt; \infty\)</span></p>
<p><strong>Quantiles</strong></p>
<p><span class="arithmatex">\(x(F) = \mu  + \sigma \Phi^{-1}(F)\)</span></p>
<p><strong>Likelihood Function</strong></p>
<p>The probability density function (PDF) of the Normal distribution is given below:</p>
<div class="arithmatex">\[
f(x_{i} : \mu, \sigma) = \frac{1}{\sigma \sqrt{2\pi }}e^{-z_{i}^2/2} , \quad
z_{i} = \frac{x_{i} - \mu}{\sigma }
\]</div>
<p>Therefore, the Log-likelihood function is defined as follows:</p>
<div class="arithmatex">\[
\ell(x:\mu, \sigma) = \sum_{i=1}^{n} \left[-\ln (\sigma \sqrt{2\pi }) - \frac{z_{i}^2}{2} \right]
\]</div>
<p><strong>L-Moments</strong></p>
<ul>
<li><span class="arithmatex">\(\lambda_{1} = \mu\)</span></li>
<li><span class="arithmatex">\(\lambda_{2} = \pi^{-1/2}\sigma \approx 0.5642\sigma\)</span></li>
<li><span class="arithmatex">\(\tau_{3} = 0\)</span></li>
<li><span class="arithmatex">\(\tau_{4} = 30\pi^{-1}\arctan \sqrt{2} - 9 \approx 0.1226\)</span></li>
</ul>
<p>We can also express the parameters in terms of the L-moments:</p>
<ul>
<li><span class="arithmatex">\(\mu = \lambda_{1}\)</span></li>
<li><span class="arithmatex">\(\sigma = \pi^{1/2}\lambda_{2}\)</span></li>
</ul>
<h3 id="log-normal-lno-distribution">Log-Normal (LNO) Distribution</h3>
<p><strong>Support</strong></p>
<p><span class="arithmatex">\(0 &lt; x &lt; \infty\)</span></p>
<p><strong>Quantiles</strong></p>
<p><span class="arithmatex">\(x(F) = \exp(\mu + \sigma \Phi^{-1}(F))\)</span></p>
<p><strong>Likelihood Function</strong></p>
<p>To derive the likleihood of the LNO distribution, we use the fact that:</p>
<div class="arithmatex">\[
\text{Data} \sim \text{LNO} \Leftrightarrow \ln (\text{Data}) \sim \text{NOR}
\]</div>
<p>Precisely, we require the change of variables formula, which states that:</p>
<div class="arithmatex">\[
\ell_{\text{LNO}}(x ; \mu, \sigma)
= \ell_{\text{NOR}}(\ln x ; \mu , \sigma) \left|\frac{d}{dx} \ln  x\right|
= \frac{\ell_{\text{NOR}}(\ln x ; \mu , \sigma)}{x}
\]</div>
<p><strong>L-Moments</strong></p>
<p>See <a href="#normal-nor-distribution">Normal Distribution</a>.</p>
<h3 id="generalized-extreme-value-gev-distribution">Generalized Extreme Value (GEV) Distribution</h3>
<p><strong>Support</strong></p>
<div class="arithmatex">\[
\begin{cases}
-\infty &lt; x \leq \mu + (\sigma/\kappa ) &amp;\kappa &gt; 0 \\[5pt]
-\infty &lt; x &lt; \infty &amp; \kappa  = 0 \\[5pt]
\mu + (\sigma /\kappa) \leq x &lt; \infty &amp; \kappa &lt; 0
\end{cases}
\]</div>
<p><strong>Quantiles</strong></p>
<div class="arithmatex">\[
x(F) = \begin{dcases}
\mu + \sigma (1 - (-\log F)^{\kappa })/\kappa  &amp;\kappa \neq 0\\[5pt]
\mu - \sigma \log (-\log F) &amp;\kappa = 0
\end{dcases}
\]</div>
<p><strong>Likelihood Function</strong></p>
<p>The probability density function (PDF) of the GEV distribution is given below (assume <span class="arithmatex">\(t_{i} &gt; 0)\)</span>:</p>
<div class="arithmatex">\[
f(x_{i} : \mu, \sigma, \kappa) = \frac{1}{\sigma}t_{i}^{-1 - (1/\kappa)} \exp (-t_{i}^{-1/\kappa}), \quad
t_{i} = 1 + \kappa \left(\frac{x_{i} - \mu }{\sigma } \right)
\]</div>
<p>Therefore, the Log-likelihood function is defined as follows:</p>
<div class="arithmatex">\[
\ell(x:\mu, \sigma, \kappa) = \sum_{i=1}^{n} \left[-\ln \sigma - \left(1 + \frac{1}{\kappa }\right) \ln t_{i} - t_{i}^{-1/\kappa}\right]
\]</div>
<p><strong>L-Moments</strong></p>
<p>The L-moments are defined for <span class="arithmatex">\(\kappa &gt; -1\)</span>:</p>
<ul>
<li><span class="arithmatex">\(\lambda_{1} = \mu + \sigma (1 - \Gamma (1 + \kappa)) / \kappa\)</span></li>
<li><span class="arithmatex">\(\lambda_{2} = \sigma (1 - 2^{-\kappa })\Gamma (1 + \kappa) / \kappa\)</span></li>
<li><span class="arithmatex">\(\tau_{3} = 2(1 - 3^{-\kappa})/(1 - 2^{-\kappa}) - 3\)</span></li>
<li><span class="arithmatex">\(\tau_{4} = [5(1 - 4^{-\kappa })-10(1-3^{-\kappa}) + 6(1-2^{-\kappa })]/(1 - 2^{-\kappa })\)</span></li>
</ul>
<p>To compute the parameters from the L-moments, we first compute <span class="arithmatex">\(c\)</span>:</p>
<div class="arithmatex">\[
c = \frac{2}{3 + \tau_{3}} - \frac{\log 2}{\log 3}
\]</div>
<p>Then, we use the following approximation<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>:</p>
<div class="arithmatex">\[
\begin{cases}
\kappa \approx 7.8590c + 2.9554c^2 \\[5pt]
\sigma \approx \lambda_{2}\kappa / (1 - 2^{-\kappa })\Gamma (1 + \kappa) \\[5pt]
\mu \approx \lambda_{1} - \sigma (1 - \Gamma (1 + \kappa )) / \kappa
\end{cases}
\]</div>
<p><strong>Note</strong>: Other sources often use a different parameterization for the GEV distribution in which the sign of the shape parameter <span class="arithmatex">\(\kappa\)</span> is flipped.
 w</p>
<h3 id="generalized-logistic-glo-distribution">Generalized Logistic (GLO) Distribution</h3>
<p><strong>Support</strong></p>
<div class="arithmatex">\[
\begin{cases}
-\infty &lt; x \leq \mu + (\sigma /\kappa ) &amp; \kappa  &gt; 0 \\[5pt]
-\infty  &lt; x &lt; \infty  &amp; \kappa  = 0 \\[5pt]
\mu  + (\sigma /\kappa ) \leq  x &lt; \infty  &amp; \kappa  &lt; 0
\end{cases}
\]</div>
<p><strong>Quantiles</strong></p>
<div class="arithmatex">\[
x(F) = \begin{cases}
\mu +\sigma [1 - ((1 - F) / F)^{\kappa}] / \kappa &amp;\kappa \neq 0 \\[5pt]
\mu - \sigma \log ((1 - F) / F) &amp; k = 0
\end{cases}
\]</div>
<p><strong>Likelihood Function</strong></p>
<p>The probability density function (PDF) of the GLO distribution is given below (assume <span class="arithmatex">\(t_{i} &gt; 0)\)</span>:</p>
<div class="arithmatex">\[
f(x_{i} : \mu , \sigma , \kappa ) = \frac{1}{\sigma }t_{i}^{(1/\kappa) - 1} \left[1 + t_{i}^{1/\kappa}\right]^{-2}, \quad
t_{i} = 1 - \kappa \left(\frac{x_{i} - \mu }{\sigma }\right)
\]</div>
<p>Therefore, the Log-likelihood function is defined as follows:</p>
<div class="arithmatex">\[
\ell(x:\mu, \sigma, \kappa) = \sum_{i=1}^{n} \left[-\ln \sigma + \left(\frac{1}{\kappa }-1\right) \ln t_{i} - 2 \ln \left(1 + t_{i}^{1/\kappa }\right) \right]
\]</div>
<p><strong>L-Moments</strong></p>
<p>The L-moments are defined for <span class="arithmatex">\(-1 &lt; \kappa &lt; 1\)</span>:</p>
<ul>
<li><span class="arithmatex">\(\lambda_{1} = \mu +\sigma [(1 / \kappa) - (\pi / \sin (\kappa\pi))]\)</span></li>
<li><span class="arithmatex">\(\lambda_{2} = \sigma \kappa \pi / \sin (\kappa \pi)\)</span></li>
<li><span class="arithmatex">\(\tau_{3} = -\kappa\)</span></li>
<li><span class="arithmatex">\(\tau_{4} = (1 + 5\kappa ^2) / 6\)</span></li>
</ul>
<p>We can also express the parameters in terms of the L-moments:</p>
<ul>
<li><span class="arithmatex">\(\kappa = -\tau_{3}\)</span></li>
<li><span class="arithmatex">\(\sigma = \lambda_{2}\sin (\kappa \pi ) / \kappa \pi\)</span></li>
<li><span class="arithmatex">\(\mu = \lambda_{1} - \sigma [(1 / \kappa) - (\pi / \sin (\kappa\pi))]\)</span></li>
</ul>
<h3 id="generalized-normal-gno-distribution">Generalized Normal (GNO) Distribution</h3>
<p><strong>Support</strong></p>
<div class="arithmatex">\[
\begin{cases}
-\infty &lt; x \leq \mu + (\sigma /\kappa ) &amp; \kappa  &gt; 0 \\[5pt]
-\infty  &lt; x &lt; \infty  &amp; \kappa  = 0 \\[5pt]
\mu  + (\sigma /\kappa ) \leq  x &lt; \infty  &amp; \kappa  &lt; 0
\end{cases}
\]</div>
<p><strong>Quantiles</strong></p>
<div class="arithmatex">\[
x(F) = \begin{cases}
\mu + \sigma [1 - \exp(-\kappa \Phi^{-1}(F))] / \kappa &amp;\kappa \neq 0 \\[5pt]
\mu + \sigma \Phi^{-1}(F) &amp;\kappa  = 0
\end{cases}
\]</div>
<p><strong>Likelihood Function</strong></p>
<p><strong>L-Moments</strong></p>
<p>The L-moments are defined for all values of <span class="arithmatex">\(\kappa\)</span>.</p>
<ul>
<li><span class="arithmatex">\(\lambda_{1} = \mu + \sigma (1 - e^{\kappa ^2/2}) / \kappa\)</span></li>
<li><span class="arithmatex">\(\lambda_{2} = \sigma e^{-\kappa ^2/ 2}[1 - 2\Phi (-\kappa  / \sqrt{2})] / \kappa\)</span></li>
</ul>
<p>To compute <span class="arithmatex">\(\tau_{3}\)</span> and <span class="arithmatex">\(\tau_{4}\)</span> we use the following approximation:</p>
<div class="arithmatex">\[
\begin{aligned}
\tau_{3} &amp;\approx -\kappa \left(\frac{A_{0} + A_{1}\kappa ^2 + A_{2}\kappa ^{4} + A_{3}\kappa ^{6}}{1 + B_{1}\kappa ^2 + B_{2}\kappa ^{4} + B_{3}\kappa ^{6}}\right)  \\[5pt]
\tau_{4} &amp;\approx \tau_{4}^{0} + \kappa ^2 \left(\frac{C_{0} + C_{1}\kappa ^2 + C_{2}\kappa ^{4} + C_{3}\kappa ^{6}}{1 + D_{1}\kappa ^2 + D_{2}\kappa ^{4} + D_{3}\kappa ^{6}}\right)
\end{aligned}
\]</div>
<p>To determine the parameters from the L-moments we also use a rational approximation:</p>
<div class="arithmatex">\[
\kappa \approx -\tau_{3} \left(\frac{E_{0} + E_{1}\tau_{3}^2 + E_{2}\tau_{3}^{4} + E_{3}\tau _{3}^{6}}{1 + F_{1}\tau _{3}^2 + F_{2}\tau _{3}^{4} + F_{3}\tau _{3}^{6}}\right)
\]</div>
<p>Then, we can find <span class="arithmatex">\(\mu\)</span> and <span class="arithmatex">\(\sigma\)</span> as a function of <span class="arithmatex">\(\kappa\)</span>:</p>
<div class="arithmatex">\[
\sigma \approx  \frac{\lambda_{2}\kappa e^{-\kappa ^2 / 2}}{1 - 2\Phi (-\kappa  / \sqrt{2})}, \quad
\mu  \approx  \lambda_{1} - \frac{\sigma }{\kappa }\left(1 - e^{-\kappa ^2 / 2 }\right)
\]</div>
<p>The coefficients (<span class="arithmatex">\(A_{i}\)</span>, <span class="arithmatex">\(B_{i}\)</span>, <span class="arithmatex">\(C_{i}\)</span>, <span class="arithmatex">\(D_{i}\)</span>, <span class="arithmatex">\(E_{i}\)</span>, <span class="arithmatex">\(F_{i}\)</span>, and <span class="arithmatex">\(\tau_{4}^{0}\)</span>) are defined in Appendix A.8 of Hosking, 1996<sup id="fnref2:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.
Although this appendix covers the 3-parameter log-normal distribution, the L-moments of the generalized normal distribution are the same.</p>
<h3 id="pearson-type-iii-pe3-distribution">Pearson Type III (PE3) Distribution</h3>
<p>The Pearson Type III distribution is typically reparameterized as follows for <span class="arithmatex">\(\kappa \neq 0\)</span>:</p>
<div class="arithmatex">\[
\begin{aligned}
\alpha &amp;= 4 / \kappa^2 \\[5pt]
\beta  &amp;= \sigma |\kappa | / 2 \\[5pt]
\xi &amp;= \mu  - 2\sigma /\kappa
\end{aligned}
\]</div>
<p><strong>Support</strong></p>
<div class="arithmatex">\[
\begin{cases}
\xi \leq  x &lt; \infty &amp;\kappa &gt; 0 \\[5pt]
-\infty &lt; x &lt; \infty  &amp;\kappa =0 \\[5pt]
-\infty  &lt; x \leq \xi &amp;\kappa  &lt; 0
\end{cases}
\]</div>
<p><strong>Quantiles</strong></p>
<div class="arithmatex">\[
x(F) = \begin{cases}
\mu - \alpha \beta + q(F, \alpha, \beta) &amp;\kappa &gt; 0\\[5pt]
\mu + \sigma \Phi^{-1}(F) &amp;\kappa  = 0\\[5pt]
\mu  + \alpha \beta  - q(1 - F, \alpha, \beta) &amp;\kappa &lt; 0
\end{cases}
\]</div>
<p>In the equations above, <span class="arithmatex">\(q\)</span> is the quantile function of the Gamma distribution with with shape <span class="arithmatex">\(\alpha\)</span> and scale <span class="arithmatex">\(\beta\)</span>. <span class="arithmatex">\(q\)</span> is defined below, where <span class="arithmatex">\(\gamma\)</span> is the <em>lower incomplete Gamma function</em>.</p>
<div class="arithmatex">\[q(F, \alpha, \beta) = \beta \gamma ^{-1}(\alpha, p \Gamma (\alpha))\]</div>
<p><strong>Likelihood Function</strong></p>
<p>The probability density function (PDF) of the PE3 distribution is given below:</p>
<div class="arithmatex">\[
f(x_{i} : \mu , \sigma , \kappa ) = \frac{(x_{i} - \xi)^{\alpha  - 1}e^{-(x_{i} - \xi )/\beta }}{\beta ^{\alpha } \Gamma (\alpha )}
\]</div>
<p>Therefore, the Log-likelihood function is defined as follows:</p>
<div class="arithmatex">\[
\ell(x:\mu, \sigma, \kappa) = \sum_{i=1}^{n} \left[(\alpha  - 1) \ln |x_{i} - \xi | - \frac{|x_{i} - \xi  |}{\beta } - \alpha \ln\beta  - \ln \Gamma (\alpha )\right]
\]</div>
<p><strong>L-Moments</strong></p>
<p>All subsequent definitions assume that <span class="arithmatex">\(\kappa &gt; 0\)</span>.
If <span class="arithmatex">\(\kappa &lt; 0\)</span>, the L-moments can be obtained by changing the signs of <span class="arithmatex">\(\lambda_{1}\)</span>, <span class="arithmatex">\(\tau_{3}\)</span>, and <span class="arithmatex">\(\xi\)</span> whenever they appear.
If <span class="arithmatex">\(\kappa = 0\)</span>, the L-moments are the same as the <a href="#normal-nor-distribution">Normal Distribution</a>.
The first two L-moments are defined as follows:</p>
<ul>
<li><span class="arithmatex">\(\lambda_{1} = \xi + \alpha \beta\)</span></li>
<li><span class="arithmatex">\(\lambda_{2} = \pi ^{-1/2} \beta \Gamma (\alpha  + 0.5) / \Gamma (\alpha )\)</span></li>
</ul>
<p>Rational approximation is necessary to determine <span class="arithmatex">\(\tau_{3}\)</span> and <span class="arithmatex">\(\tau_{4}\)</span>. If <span class="arithmatex">\(\alpha \geq 1\)</span>:</p>
<div class="arithmatex">\[
\begin{aligned}
\tau_{3} &amp;\approx \alpha^{-1/2} \left(\frac{A_{0} + A_{1}\alpha^{-1} + A_{2}\alpha^{-2} + A_{3}\alpha^{-3}}{1 + B_{1}\alpha^{-1} + B_{2}\alpha ^{-2}}\right)  \\[5pt]
\tau_{4} &amp;\approx \frac{C_{0} + C_{1}\alpha^{-1} + C_{2}\alpha ^{-2} +C_{3}\alpha ^{-3}}{1 + D_{1}\alpha ^{-1} + D_{2}\alpha ^{-2}}
\end{aligned}
\]</div>
<p>If <span class="arithmatex">\(\alpha &lt; 1\)</span> we use a different set of coefficients:</p>
<div class="arithmatex">\[
\begin{aligned}
\tau_{3} &amp;\approx \frac{1 + E_{1}\alpha  + E_{2}\alpha ^2 + E_{3}\alpha ^3}{1 + F_{1}\alpha  + F_{2}\alpha ^2 + F_{3}\alpha ^3} \\[5pt]
\tau_{4} &amp;\approx \frac{1 + G_{1}\alpha + G_{2}\alpha ^2 + G_{3}\alpha ^3}{1 + H_{1}\alpha + H_{2}\alpha ^2 + H_{3}\alpha ^3}
\end{aligned}
\]</div>
<p>Coefficients are given in Appendix A.9 of Hosking, 1996<sup id="fnref3:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.
To estimate parameters from the L-moments, we use one of two approximations for <span class="arithmatex">\(\alpha\)</span> depending on the value of <span class="arithmatex">\(\tau_{3}\)</span>:</p>
<div class="arithmatex">\[
\alpha \approx \begin{dcases}
\frac{1 + 0.2906z}{z + 0.1882z^2 + 0.0442z^3}, &amp;z = 3\pi \tau_{3}^2, &amp;0 &lt; |\tau_{3}| &lt; \frac{1}{3} \\[5pt]
\frac{0.36067z - 0.59567z^2 + 0.25361z^3}{1 - 2.78861z + 2.56096z^2 - 0.77045z^3}, &amp;z = 1 - |\tau_{3}|, &amp;\frac{1}{3} \leq |\tau_{3}| &lt; 1
\end{dcases}
\]</div>
<p>Then, we can determine the parameters from the approximated <span class="arithmatex">\(\alpha\)</span>:</p>
<div class="arithmatex">\[
\begin{aligned}
\kappa &amp;= 2\alpha ^{-1/2} \text{sign} (\tau_{3}) \\[5pt]
\sigma &amp;= \lambda_{2} \pi^{1/2}\alpha ^{1/2} \Gamma (\alpha )/\Gamma (\alpha + 0.5)\\[5pt]
\mu &amp;= \lambda_{1 }
\end{aligned}
\]</div>
<h3 id="log-pearson-type-iii-lp3-distribution">Log-Pearson Type III (LP3) Distribution</h3>
<p>The LP3 distribution uses the same reparameterization as the <a href="#pearson-type-iii-pe3-distribution">PE3 distribution</a>.</p>
<p><strong>Support</strong></p>
<div class="arithmatex">\[
\begin{cases}
\max(0, \xi) \leq  x &lt; \infty &amp;\kappa &gt; 0 \\[5pt]
0 &lt; x &lt; \infty  &amp;\kappa =0 \\[5pt]
0  &lt; x \leq \max(0, \xi) &amp;\kappa  &lt; 0
\end{cases}
\]</div>
<p><strong>Quantiles</strong></p>
<p><span class="arithmatex">\(x(F) = \exp(x_{\text{PE3}}(F ))\)</span>, where <span class="arithmatex">\(x_{\text{PE3}}(F)\)</span> is the quantile function of the <a href="#pearson-type-iii-pe3-distribution">PE3 distribution</a>.</p>
<p><strong>Likelihood Function</strong></p>
<p>To derive the likelihood of the LP3 distribution, we use the fact that:</p>
<div class="arithmatex">\[
\text{Data} \sim \text{LP3}  \Leftrightarrow \ln (\text{Data}) \sim \text{PE3}
\]</div>
<p>Precisely, we require the change of variables formula, which states that:</p>
<div class="arithmatex">\[
\ell_{\text{LP3}}(x ; \mu, \sigma, \kappa)
= \ell_{\text{PE3}}(\ln x ; \mu , \sigma, \kappa ) \left|\frac{d}{dx} \ln  x\right|
= \frac{\ell_{\text{PE3}}(\ln x ; \mu , \sigma, \kappa )}{x}
\]</div>
<p><strong>L-Moments</strong></p>
<p>Same as the <a href="#pearson-type-iii-pe3-distribution">PE3 distribution</a>.</p>
<h3 id="weibull-wei-distribution">Weibull (WEI) Distribution</h3>
<p>The Weibull distribution is a reparameterized version of the generalized extreme value distribution:</p>
<div class="arithmatex">\[
\begin{aligned}
\kappa &amp;= 1 / \kappa_{\text{GEV}} \\[5pt]
\sigma &amp;= \kappa \sigma_{\text{GEV} } \\[5pt]
\mu &amp;= \sigma + \mu_{\text{GEV} }
\end{aligned}
\]</div>
<p>Under this reparameterization, it is required that <span class="arithmatex">\(\sigma &gt; 0\)</span> and <span class="arithmatex">\(\kappa &gt; 0\)</span>.</p>
<p><strong>Support</strong></p>
<p><span class="arithmatex">\(\mu \leq x &lt; \infty\)</span></p>
<p><strong>Quantiles</strong></p>
<p><span class="arithmatex">\(x(F) = \mu + \sigma (-\log (1 - F))^{1/\kappa}\)</span></p>
<p><strong>Likelihood Function</strong></p>
<p>The probability density function (PDF) of the Weibull distribution is given below for <span class="arithmatex">\(x_{i} &gt; \mu\)</span>:</p>
<div class="arithmatex">\[
f(x_{i} : \mu, \sigma, \kappa) = \frac{\kappa}{\sigma }\left(\frac{x_{i} - \mu}{\sigma }\right)^{\kappa -1} \exp \left( - \left(\frac{x_{i} - \mu}{\sigma }\right)^{\kappa } \right)
\]</div>
<p>Therefore, the Log-likelihood function is defined as follows:</p>
<div class="arithmatex">\[
\ell(x:\mu, \sigma, \kappa) = \sum_{i=1}^{n} \left[\ln \kappa - \kappa \ln \sigma +(\kappa -1)\ln (x_{i}-\mu ) - \left(\frac{x_{i} - \mu }{\sigma }\right) ^{\kappa } \right]
\]</div>
<p><strong>L-Moments</strong></p>
<p>First, reparameterize the Weibull distribution and to recover the GEV parameters:</p>
<div class="arithmatex">\[
\begin{aligned}
\kappa_{\text{GEV}} &amp;= 1 / \kappa \\[5pt]
\sigma_{\text{GEV}} &amp;= \sigma / \kappa \\[5pt]
\end{aligned}
\]</div>
<p>Next, compute the L-moments for the <a href="#generalized-extreme-value-gev-distribution">GEV distribution</a> with <span class="arithmatex">\(\mu_{\text{GEV}} = 0\)</span>.
Then,</p>
<ul>
<li><span class="arithmatex">\(\lambda_{1} = \mu + \sigma - \lambda_{1, \text{GEV}}\)</span></li>
<li><span class="arithmatex">\(\lambda_{2} = \lambda_{2, \text{GEV}}\)</span></li>
<li><span class="arithmatex">\(\tau_{3} = -\tau_{3, \text{GEV}}\)</span></li>
<li><span class="arithmatex">\(\tau_{4} = \tau_{4, \text{GEV} }\)</span></li>
</ul>
<p>To compute the parameters from the L-moments, first flip the sign of <span class="arithmatex">\(\lambda_{1}\)</span> and <span class="arithmatex">\(\tau_{3}\)</span>.
Then, estimate the parameters of the GEV distribution to get <span class="arithmatex">\(\hat{\mu}_{\text{GEV}}\)</span>, <span class="arithmatex">\(\hat{\sigma}_{\text{GEV}}\)</span>, and <span class="arithmatex">\(\hat{\kappa}_{\text{GEV}}\)</span>.
Finally, reparameterize the GEV parameters as shown <a href="#weibull-wei-distribution">here</a> and then flip the sign of <span class="arithmatex">\(\mu\)</span>.</p>
<h3 id="kappa-kap-distribution">Kappa (KAP) Distribution</h3>
<p>The Kappa distribution has location <span class="arithmatex">\(\mu\)</span>, scale <span class="arithmatex">\(\sigma\)</span>, and two shape parameters <span class="arithmatex">\(\kappa\)</span> and <span class="arithmatex">\(h\)</span>.</p>
<p><strong>Support</strong></p>
<div class="arithmatex">\[
\begin{cases}
\mu + \sigma (1 - h^{-\kappa}) \leq x \leq \mu + (\sigma /\kappa ) &amp; \kappa &gt; 0, h &gt; 0 \\[5pt]
-\infty &lt; x \leq \mu + (\sigma /\kappa) &amp; \kappa &gt; 0, h \leq 0 \\[5pt]
\mu + \sigma (1 - h^{-\kappa}) \leq x &lt; \infty &amp;\kappa \leq 0, h &gt; 0 \\[5pt]
\mu + (\sigma / \kappa ) \leq x &lt;\infty &amp;\kappa  \leq 0, h \leq 0
\end{cases}
\]</div>
<p><strong>Quantiles</strong></p>
<div class="arithmatex">\[
x(F) = \mu + \frac{\sigma }{\kappa }\left[1 - \left(\frac{1 - F^{h}}{h}\right)^{\kappa }\right] 
\]</div>
<p><strong>L-Moments</strong></p>
<p>The L-moments are defined if <span class="arithmatex">\(h \geq 0\)</span> and <span class="arithmatex">\(k &gt; -1\)</span> or if <span class="arithmatex">\(h &lt; 0\)</span> and  <span class="arithmatex">\(-1 &lt; k &lt; -1/h\)</span>.</p>
<ul>
<li><span class="arithmatex">\(\lambda_{1} = \mu  + \sigma (1 - g_{1})/\kappa\)</span></li>
<li><span class="arithmatex">\(\lambda_{2} = \sigma(g_{1} - g_{2})/\kappa\)</span></li>
<li><span class="arithmatex">\(\tau_{3} = (-g_{1} + 3g_{2} - 2g_{3}) / (g_{1} - g_{2})\)</span> </li>
<li><span class="arithmatex">\(\tau_{4} = (-g_{1} + 6g_{2} - 10g_{3} + 5g_{4}) / (g_{1} - g_{2})\)</span></li>
</ul>
<p>In the expression above, <span class="arithmatex">\(g_{r}\)</span> is defined as follows:</p>
<div class="arithmatex">\[
g_{r} = \begin{dcases}
\frac{r\Gamma (1 + \kappa )\Gamma (r / h)}{h^{1 + \kappa }\Gamma (1 + \kappa + r/h)} &amp;h &gt; 0 \\[5pt]
\frac{r\Gamma (1 + \kappa ) \Gamma (-\kappa  - r/h)}{(-h)^{1 + \kappa }\Gamma (1 - r/h)} &amp;h &lt; 0
\end{dcases}
\]</div>
<p>There is no closed-form solution for the parameters in terms of the L-moments. 
However, <span class="arithmatex">\(\tau_{3}\)</span> and <span class="arithmatex">\(\tau_{4}\)</span> can be computed in terms of <span class="arithmatex">\(\kappa\)</span> and <span class="arithmatex">\(h\)</span> using Newton-Raphson iteration.</p>
<h2 id="sources">Sources</h2>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Hosking, J.R.M. &amp; Wallis, J.R., 1997. Regional frequency analysis: an aproach based on L-Moments. Cambridge University Press, New York, USA.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:1" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>Hosking, J.R.M., Wallis, J.R., &amp; Wood, E.F., 1985. Estimation of the generalized extreme-value distribution by the method of probability-weighted moments. Technometrics, 27, 251-61.&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../eda/" class="btn btn-neutral float-left" title="Exploratory Data Analysis"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../model-selection/" class="btn btn-neutral float-right" title="Model Selection">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../eda/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../model-selection/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-chtml-full.min.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
