<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Model Selection - FFA Framework</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Model Selection";
        var mkdocs_page_input_path = "model-selection.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> FFA Framework
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Command Line Interface</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cli-introduction/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cli-installation/">Installation Instructions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cli-manual/">User Manual</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">R Package</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../r-installation/">Installation instructions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../r-documentation.pdf">User Manual</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Vignettes</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../vignettes/introduction.html">Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../vignettes/change-points.html">Change Point Detection</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../vignettes/trend-identification.html">Trend Identification</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../vignettes/stationary-ffa.html">Stationary FFA</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../vignettes/non-stationary-ffa.html">Non-Stationary FFA</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Concepts</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../eda/">Exploratory Data Analysis</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../distributions/">Probability Distributions</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Model Selection</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#an-introduction-to-l-moments">An Introduction to L-Moments</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#example-plot">Example Plot</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#selection-metrics">Selection Metrics</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#l-distance">L-Distance</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#l-kurtosis">L-Kurtosis</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#z-statistic">Z-statistic</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#handling-non-stationarity">Handling Non-Stationarity</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#decomposition-scenario-1">Decomposition (Scenario 1)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#decomposition-scenario-2">Decomposition (Scenario 2)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#decomposition-scenario-3">Decomposition (Scenario 3)</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../parameter-estimation/">Parameter Estimation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../frequency-analysis/">Frequency Analysis</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../uncertainty-quantification/">Uncertainty Quantification</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../model-assessment/">Model Assessment</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../goals/">Goals</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../roadmap/">Roadmap</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../changelog/">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../matlab/">MATLAB Version</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../license/">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">FFA Framework</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Concepts</li>
      <li class="breadcrumb-item active">Model Selection</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="model-selection">Model Selection</h1>
<p>Our framework uses the method of L-moment ratios to choose a suitable probability model for frequency analysis.
This technique involves comparing the L-moments of the data with the known L-moments of various probability distributions.</p>
<h2 id="an-introduction-to-l-moments">An Introduction to L-Moments</h2>
<p><strong>Definition</strong>: The <strong><span class="arithmatex">\(k\)</span>-th Order Statistic</strong> of a statistical sample is its <span class="arithmatex">\(k\)</span>-th smallest value.</p>
<p><strong>Definition</strong>: The <strong><span class="arithmatex">\(r\)</span>-th Population L-moment</strong> <span class="arithmatex">\(\lambda_{r}\)</span> is a linear combination of the expectation of the order statistics. Let <span class="arithmatex">\(X_{k:n}\)</span> be the <span class="arithmatex">\(k\)</span>-th order statistic from a sample of size <span class="arithmatex">\(n\)</span>. Then,</p>
<div class="arithmatex">\[
\lambda_{r} = \frac{1}{r} \sum_{k=0}^{r-1} (-1)^{k} \binom{r-1}{k} \mathbb{E}[X_{r-k:r}]
\]</div>
<p><strong>Definition</strong>: A <strong>Probability Weighted Moment</strong> (PWM) encodes information about a value's position on the cumulative distribution function. The <span class="arithmatex">\(r\)</span>-th PWM, denoted <span class="arithmatex">\(\beta_{r}\)</span>, is:</p>
<div class="arithmatex">\[
\beta_{r} = \mathbb{E}[X \cdot  F(X)^{r}]
\]</div>
<p>For an ordered sample <span class="arithmatex">\(x_{1:n} \leq  \dots  \leq  x_{n:n}\)</span>, the sample PWM is often estimated as:</p>
<div class="arithmatex">\[
b_{r} = \frac{1}{n} \sum_{i=1}^{r} x_{i:n} \left(\frac{i-1}{n-1}\right) ^{r}
\]</div>
<p><strong>Remark</strong>: The first four sample L-moments can be computed as linear combinations of the PWMs:</p>
<div class="arithmatex">\[
\begin{aligned}
l_{1} &amp;= b_{0} \\
l_{2} &amp;= 2b_{1} - b_{0} \\
l_{3} &amp;= 6b_{2} - 6b_{1} + b_{0} \\
l_{4} &amp;= 20b_{3} - 30b_{2} + 12b_{1} - b_{0}
\end{aligned}
\]</div>
<p>The L-moments are used to compute the <strong>Sample L-variance</strong> <span class="arithmatex">\(t_{2}\)</span>, <strong>Sample L-skewness</strong> <span class="arithmatex">\(t_{3}\)</span> and the <strong>Sample L-kurtosis</strong> <span class="arithmatex">\(t_{4}\)</span> using the following formulas:</p>
<div class="arithmatex">\[
\begin{aligned}
t_{2} &amp;= l_{2} / l_{1} \\
t_{3} &amp;= l_{3} / l_{2} \\ 
t_{4} &amp;= l_{4} / l_{2}
\end{aligned}
\]</div>
<p>Then, we compare these statistics, specifically the L-skewness and L-kurtosis to their theoretical values (given <a href="../distributions/">here</a>) using one of three different metrics to select a distribution.</p>
<p><strong>Note</strong>: Probability distributions with less than three parameters have constant L-skewness <span class="arithmatex">\(\tau_{3}\)</span> and L-kurtosis <span class="arithmatex">\(\tau_{4}\)</span> regardless of their parameters.
The L-skewness and L-kurtosis of probability distributions with three parameters is a function of the shape parameter <span class="arithmatex">\(\kappa\)</span>.
The notation <span class="arithmatex">\(\tau_{3}(\kappa)\)</span> and <span class="arithmatex">\(\tau_{4}(\kappa)\)</span> refers to the L-skewness and L-kurtosis <em>curves</em> for the three parameter distributions.</p>
<h3 id="example-plot">Example Plot</h3>
<p>Shown below are the L-moment curves of the <code>GEV</code>,<code>GLO</code>,<code>GNO</code>,<code>PE3</code>/<code>LP3</code>, and <code>WEI</code> distributions.
The L-moment ratios of the two parameter distributions <code>GUM</code> and <code>NOR</code>/<code>LNO</code>.
This example uses the "L-distance" selection metric.
The zoomed-in region shows that the GEV distribution is most similar to the sample L-moments.</p>
<p><img alt="" src="../img/plot-lmom.png" /></p>
<h2 id="selection-metrics">Selection Metrics</h2>
<h3 id="l-distance">L-Distance</h3>
<p>Compare the euclidean distance between the sample L-skewness and sample L-kurtosis <span class="arithmatex">\((t_{3}, t_{4})\)</span> and the known L-moment ratios <span class="arithmatex">\((\tau_{3}, \tau_{4})\)</span> for each candidate distribution.
For probability distributions with three parameters, we use the <em>minimum distance</em> between the L-moment ratio curve <span class="arithmatex">\((\tau _{3}(\kappa ), \tau _{4}(\kappa ))\)</span>and the L-moment ratios of the sample <span class="arithmatex">\((t_{3}, t_{4})\)</span>.</p>
<h3 id="l-kurtosis">L-Kurtosis</h3>
<p>For two-parameter probability distributions, simply compare the difference between the sample L-kurtosis and the theoretical L-kurtosis using the metric <span class="arithmatex">\(|\tau_{4} - t_{4} |\)</span>.
For three-parameter distributions, we first identify the shape parameter <span class="arithmatex">\(\kappa^{*}\)</span> such that <span class="arithmatex">\(t_{3} = \tau _{3}(\kappa ^{*})\)</span>.
Then, compare the difference between the sample L-kurtosis and the theoretical L-kurtosis using the metric <span class="arithmatex">\(|\tau_{4}(\kappa ^{*}) - t_{4} |\)</span>.</p>
<h3 id="z-statistic">Z-statistic</h3>
<p>The Z-statistic selection metric is calculated as follows (for three parameter distributions):</p>
<ol>
<li>Fit the four-parameter Kappa (K4D) distribution to the data using <span class="arithmatex">\(t_{2}\)</span>, <span class="arithmatex">\(t_{3}\)</span>, and <span class="arithmatex">\(t_{4}\)</span>.</li>
<li>Generate <span class="arithmatex">\(N_{\text{sim}}\)</span> bootstrap samples from the fitted K4D distribution.</li>
<li>Calculate the sample L-kurtosis <span class="arithmatex">\(t_{4}^{[i]}\)</span> of each synthetic dataset.</li>
<li>
<p>Calculate the bias and standard deviation of the bootstrap distribution:</p>
<div class="arithmatex">\[
B_{4} = N_{\text{sim} }^{-1} \sum_{i = 1}^{N_{\text{sim} }} \left(t_{4}^{[i]} - t_{4}^{s}\right)
\]</div>
<div class="arithmatex">\[
\sigma _{4} = \left[(N_{\text{sim} } - 1)^{-1} \left\{\sum_{i - 1}^{N_{\text{sim} }} \left(t_{4}^{[i]} - t_{4}^{s}\right)^2 - N_{\text{sim} } B_{4}^2\right\} \right] ^{\frac{1}{2}}
\]</div>
</li>
<li>
<p>Identify the shape parameter <span class="arithmatex">\(\kappa^{*}\)</span> such that <span class="arithmatex">\(t_{3} = \tau _{3}(\kappa ^{*})\)</span>.</p>
</li>
<li>
<p>Use bootstrap distribution to compute the Z-statistic for each distribution:</p>
<div class="arithmatex">\[
z = \frac{\tau_{4} (\kappa ^{*}) - t_{4} + B_{4} }{ \sigma _{4}}
\]</div>
</li>
<li>
<p>Choose the distribution with the <em>smallest</em> Z-statistic.</p>
</li>
</ol>
<h2 id="handling-non-stationarity">Handling Non-Stationarity</h2>
<p>There are three non-stationary scenarios that can be identified during EDA:</p>
<ol>
<li><code>10</code>/<code>100</code>: Significant trend in the mean only.</li>
<li><code>01</code>/<code>010</code>: Significant trend in the variance only.</li>
<li><code>11</code>/<code>110</code>: Significant trend in both the mean and variance.</li>
</ol>
<p>To determine the best probability distribution for non-stationary data, we <em>decompose</em> the data into stationary and non-stationary components and then use one of the methods described above.</p>
<h3 id="decomposition-scenario-1">Decomposition (Scenario 1)</h3>
<ol>
<li>Use <a href="../eda/#sens-trend-estimator">Sen's Trend Estimator</a> to identify the slope <span class="arithmatex">\(b_{1}\)</span> and intercept <span class="arithmatex">\(b_{0}\)</span> of the trend. </li>
<li>Detrend the data by subtracting the linear function <span class="arithmatex">\((b_{1} \cdot \text{Covariate})\)</span> from the data, where the <em>covariate</em> is a value between <span class="arithmatex">\([0, 1]\)</span> derived from the index.</li>
<li>If necessary, enforce positivity by adding a constant such that <span class="arithmatex">\(\min(\text{data}) = 1\)</span> .</li>
</ol>
<h3 id="decomposition-scenario-2">Decomposition (Scenario 2)</h3>
<ol>
<li>Use a moving-window algorithm to compute the variance of the data. </li>
<li>Use <a href="../eda/#sens-trend-estimator">Sen's Trend Estimator</a> to identify the slope <span class="arithmatex">\(c_{1}\)</span> and intercept <span class="arithmatex">\(c_{0}\)</span> of the trend in the variance. </li>
<li>
<p>Normalize the data to have mean <span class="arithmatex">\(0\)</span>, then divide out the scale factor <span class="arithmatex">\(g_{t}\)</span>.</p>
<div class="arithmatex">\[
g_{t} = \frac{(c_{1} \cdot  \text{Covariate} ) + c_{0}}{c_{0}}
\]</div>
</li>
<li>
<p>Add back the long-term mean <span class="arithmatex">\(\mu\)</span>, and then ensure positivity as in Scenario 1.</p>
</li>
</ol>
<h3 id="decomposition-scenario-3">Decomposition (Scenario 3)</h3>
<ol>
<li>Remove the linear (additive) trend exactly as in Scenario 1.</li>
<li>On that detrended series, compute a rolling‚Äêwindow STD series and fit its trend.</li>
<li>Divide the detrended data by the time-varying scale factor <span class="arithmatex">\(g_{t}\)</span> (as in Scenario 2).</li>
<li>Shift to preserve the series mean and ensure positivity.</li>
</ol>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../distributions/" class="btn btn-neutral float-left" title="Probability Distributions"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../parameter-estimation/" class="btn btn-neutral float-right" title="Parameter Estimation">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../distributions/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../parameter-estimation/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-chtml-full.min.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
