<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Trends in AMS Mean - FFA Framework</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Trends in AMS Mean";
        var mkdocs_page_input_path = "eda-trend-ams-mean.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> FFA Framework
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">R Package</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../r-installation-instructions/">Installation instructions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../r-user-manual.pdf">User Manual</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../vignettes/">Vignettes</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Exploratory Data Analysis</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../eda-introduction/">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../eda-change-points/">Change Points</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Trends in AMS Mean</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#bb-mk-test">BB-MK Test</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#steps">Steps</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#example-plot">Example Plot</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#kpss-test">KPSS Test</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#steps_1">Steps</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#mann-kendall-mk-test">Mann-Kendall (MK) Test</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#phillips-perron-pp-test">Phillips-Perron (PP) Test</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#steps_2">Steps</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#runs-test">Runs Test</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#steps_3">Steps</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#example-plot_1">Example Plot</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#sens-trend-estimator">Sen's Trend Estimator</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#steps_4">Steps</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#example-plot_2">Example Plot</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#spearman-test">Spearman Test</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#example-plot_3">Example Plot</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../eda-trend-ams-variability/">Trends in AMS Variability</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Flood Frequency Analysis</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ffa-introduction/">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../probability-distributions/">Probability Distributions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../model-selection/">Model Selection</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../parameter-estimation/">Parameter Estimation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../uncertainty-quantification/">Uncertainty Quantification</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../model-assessment/">Model Assessment</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Other</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../goals/">Goals</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../roadmap/">Roadmap</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../release-notes/">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../matlab-version/">MATLAB Version</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../license/">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">FFA Framework</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Exploratory Data Analysis</li>
      <li class="breadcrumb-item active">Trends in AMS Mean</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="detecting-and-characterizing-trends-in-the-ams-mean">Detecting and Characterizing Trends in the AMS Mean</h1>
<p>This section describes the statistical tests (listed in alphabetical order) used to detect and characterizesignificant trends in the mean of the annual maximum series (AMS).
These tests help identify a trend, identify autocorrelation, and determine whether a trend is deterministic/stochastic and linear/non-linear.</p>
<hr />
<h2 id="bb-mk-test">BB-MK Test</h2>
<p>The <strong>Block Bootstrap Mann-Kendall (BB-MK) Test</strong> assesses the presence of a statistically significant monotonic trend in a time series.
The BB-MK test is insensitive to <a href="https://en.wikipedia.org/wiki/Autocorrelation">autocorrelation</a>, which is known to produce false positives in the <a href="#mann-kendall-mk-test">MK test</a>.</p>
<ul>
<li>Null hypothesis: No monotonic trend.</li>
<li>Alternative hypothesis: A monotonic upward or downward trend exists.</li>
</ul>
<p>To conduct the BB-MK test, we rely on the results of the MK test and the Spearman autocorrelation test.</p>
<h3 id="steps">Steps</h3>
<ol>
<li>Compute the MK test statistic (see below).</li>
<li>Use the Spearman test (see below) to identify the least insignificant lag <span class="arithmatex">\(k\)</span>.</li>
<li>Resample the time series in blocks of size <span class="arithmatex">\(k+1\)</span> without replacement.</li>
<li>Compute the MK test statistic for each bootstrapped sample.</li>
<li>Derive the empirical distribution of the MK test statistic from the bootstrapped statistics.</li>
<li>Estimate the significance of the observed test statistic using the empirical distribution.</li>
</ol>
<h3 id="example-plot">Example Plot</h3>
<p><img alt="" src="../img/plot-bbmk.png" /></p>
<hr />
<h2 id="kpss-test">KPSS Test</h2>
<p>The <strong>KPSS Test</strong> determines whether an autoregressive time series has a <a href="https://en.wikipedia.org/wiki/Unit_root">unit root</a>.
This test helps assess if the time series has a deterministic linear trend.</p>
<ul>
<li>Null hypothesis: The time series has a deterministic linear trend.</li>
<li>Alternative hypothesis: The time series has a unit root (stochastic trend).</li>
</ul>
<p>The autoregressive time series shown below has a unit root if <span class="arithmatex">\(\sigma_{v}^2 &gt; 0\)</span>:</p>
<div class="arithmatex">\[
\begin{align}
y_{t} &amp;= \mu_{t} + \beta t +  \epsilon_{t} \\[5pt]
\mu_{t} &amp;= \mu_{t-1} + v_{t} \\[5pt]
v_{t} &amp;\sim \mathcal{N}(0, \sigma_{v}^2)
\end{align}
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(\mu_{t}\)</span> is the <em>drift</em>, or the deviation of <span class="arithmatex">\(y_{t}\)</span> from <span class="arithmatex">\(0\)</span>.
  Under the null hypothesis, <span class="arithmatex">\(\mu_{t}\)</span> is constant (since <span class="arithmatex">\(v_{t}\)</span> is constant).
  Under the alternative hypothesis, <span class="arithmatex">\(\mu_t\)</span> is a stochastic process with a unit root.</li>
<li><span class="arithmatex">\(\beta t\)</span> is a <em>linear trend</em>, which represents deterministic nonstationarity (e.g., climate change).</li>
<li><span class="arithmatex">\(\epsilon_{t}\)</span> is <em>stationary noise</em>, corresponding to reversible fluctuations in <span class="arithmatex">\(y_{t}\)</span>.
  In hydrology, <span class="arithmatex">\(\epsilon_{t}\)</span> represents fluctuations in streamflow due to natural variability.</li>
<li><span class="arithmatex">\(v_{t}\)</span> is <em>random walk innovation</em>, or irreversible fluctuations in <span class="arithmatex">\(\mu_{t}\)</span>.</li>
</ul>
<h3 id="steps_1">Steps</h3>
<ol>
<li>Fit a linear model to <span class="arithmatex">\(y_{t}\)</span> and get the residuals <span class="arithmatex">\(\hat{r}_{t}\)</span>.</li>
<li>
<p>Compute the cumulative partial-sum statistics <span class="arithmatex">\(S_{k}\)</span> using the following formula:</p>
<div class="arithmatex">\[
S_{k} = \sum_{t=1}^{k} \hat{r}_{t}
\]</div>
<p>Under the null hypothesis, <span class="arithmatex">\(S_{k}\)</span> will behave like a random walk with finite variance.</p>
<p>If <span class="arithmatex">\(y_{t}\)</span> has a unit root, then the sums will "drift" too much.</p>
</li>
<li>
<p>Estimate the long-run variance of the time series using a <a href="https://en.wikipedia.org/wiki/Newey%E2%80%93West_estimator">Newey-West estimator</a>: </p>
<div class="arithmatex">\[
\hat{\lambda}^2 = \hat{\gamma}_0 + 2 \sum_{j=1}^{q} \left(1 - \frac{j}{q+1} \right) \hat{\gamma}_j
\]</div>
<p>Where <span class="arithmatex">\(q = \left\lfloor \frac{3\sqrt{n}}{13} \right\rfloor\)</span> and each autocovariance <span class="arithmatex">\(\hat{\gamma}_j\)</span> is:</p>
<div class="arithmatex">\[
\hat{\gamma}_j = \frac{1}{n} \sum_{t = j+1}^{n} \hat{r}_t \hat{r}_{t-j}
\]</div>
</li>
<li>
<p>Compute the test statistic <span class="arithmatex">\(z_{K}\)</span>:</p>
<div class="arithmatex">\[
z_{K} = \frac{1}{n^2\hat{\lambda }^2}\sum_{k=1}^{n}  S_{k}^2
\]</div>
</li>
<li>
<p>Since the test statistic <span class="arithmatex">\(z_{K}\)</span> is non-normally distributed, we compute the p-value by interpolating the table of quantiles from <a href="https://doi.org/10.1111/j.1467-9574.2004.00272.x">Hobjin et al. (2004)</a> shown below.</p>
</li>
</ol>
<table>
<thead>
<tr>
<th><span class="arithmatex">\(q\)</span></th>
<th>0.90</th>
<th>0.95</th>
<th>0.975</th>
<th>0.99</th>
</tr>
</thead>
<tbody>
<tr>
<td>Statistic</td>
<td>0.119</td>
<td>0.146</td>
<td>0.176</td>
<td>0.216</td>
</tr>
</tbody>
</table>
<p><strong>Warning</strong>: The interpolation only works for <span class="arithmatex">\(0.01 &lt; p &lt; 0.10\)</span> (p-values below <span class="arithmatex">\(0.01\)</span> and above <span class="arithmatex">\(0.10\)</span> will be truncated) and significance levels <span class="arithmatex">\(\alpha\)</span> between <span class="arithmatex">\(0.01\)</span> and <span class="arithmatex">\(0.10\)</span>.</p>
<hr />
<h2 id="mann-kendall-mk-test">Mann-Kendall (MK) Test</h2>
<p>The <strong>Mann-Kendall (MK) Test</strong> detects statistically significant monotonic trends in a time series under the assumption of independence (i.e. no autocorrelation).</p>
<ul>
<li>Null hypothesis: There is no monotonic trend.</li>
<li>Alternative hypothesis: A (upward or downward) monotonic trend exists.</li>
</ul>
<p>Define <span class="arithmatex">\(\text{sign} (x)\)</span> to be <span class="arithmatex">\(1\)</span> if <span class="arithmatex">\(x &gt; 0\)</span>, <span class="arithmatex">\(0\)</span> if <span class="arithmatex">\(x = 0\)</span>, and <span class="arithmatex">\(-1\)</span> otherwise.</p>
<p>The test statistic <span class="arithmatex">\(S\)</span> is defined as follows:</p>
<div class="arithmatex">\[
S = \sum_{k-1}^{n-1}  \sum_{j - k + 1}^{n} \text{sign} (y_{j} - y_{k})
\]</div>
<p>Next, we need to compute <span class="arithmatex">\(\text{Var}(S)\)</span>, which depends on the number of tied groups in the data.
Let <span class="arithmatex">\(g\)</span> be the number of tied groups and <span class="arithmatex">\(t_{p}\)</span> be the number of observations in the <span class="arithmatex">\(p\)</span>-th group.</p>
<div class="arithmatex">\[\text{Var}(S) = \frac{1}{18} \left[n(n-1)(2n + 1) - \sum_{p-1}^{g} t_{p}(t_{p} - 1)(2t_{p} + 5) \right]\]</div>
<p>Then, compute the normally distributed test statistic <span class="arithmatex">\(Z_{MK}\)</span> as follows:</p>
<div class="arithmatex">\[
Z_{MK} = \begin{cases}
\frac{S-1}{\sqrt{\text{Var}(S)}} &amp;\text{if } S &gt; 0 \\
0 &amp;\text{if }  S = 0 \\
\frac{S+1}{\sqrt{\text{Var}(S)}} &amp;\text{if } S &lt; 0
\end{cases}
\]</div>
<p>For a two-sided test, we reject the null hypothesis if <span class="arithmatex">\(|Z_{MK}| \geq Z_{1 - (\alpha/2) }\)</span> and conclude that there is a statistically significant monotonic trend in the data.
For more information, see <a href="https://vsp.pnnl.gov/help/vsample/design_trend_mann_kendall.htm">here</a>.</p>
<hr />
<h2 id="phillips-perron-pp-test">Phillips-Perron (PP) Test</h2>
<p>The <strong>PP Test</strong> identifies if an autoregressive time series has a <a href="https://en.wikipedia.org/wiki/Unit_root">unit root</a>.</p>
<ul>
<li>Null hypothesis: The time series has a unit root (stochastic trend).</li>
<li>Alternative hypothesis: The time series has a deterministic linear trend.</li>
</ul>
<p>Precisely, let <span class="arithmatex">\(x_{t}\)</span> be an <a href="https://en.wikipedia.org/wiki/Autoregressive_model">AR(1)</a> model.
Let <span class="arithmatex">\(y_{t}\)</span> be a function of <span class="arithmatex">\(x_{t}\)</span> with drift <span class="arithmatex">\(\beta_{0}\)</span> and trend <span class="arithmatex">\(\beta_{1} t\)</span>.</p>
<div class="arithmatex">\[
\begin{align}
y_{t} &amp;= \beta_{0} + \beta_{1} t + x_{t} \\[5pt]
x_{t} &amp;= \rho x_{t-1} + \epsilon_{t}
\end{align}
\]</div>
<ul>
<li>If <span class="arithmatex">\(\rho = 1\)</span>, then <span class="arithmatex">\(x_t\)</span> and hence <span class="arithmatex">\(y_t\)</span> has a <em>unit root</em> (null hypothesis).</li>
<li>If <span class="arithmatex">\(\rho &lt; 1\)</span>, then <span class="arithmatex">\(y_t\)</span> is <em>trend stationary</em> (alternative hypothesis).</li>
</ul>
<h3 id="steps_2">Steps</h3>
<ol>
<li>Fit a linear autoregressive model to the time series <span class="arithmatex">\(y_{t}\)</span>. Let <span class="arithmatex">\(\hat{r}_{t}\)</span> be the residuals of this model. From this model, we can determine <span class="arithmatex">\(\hat{\rho}\)</span> (the estimated coefficient on <span class="arithmatex">\(y_{t-1}\)</span>) and <span class="arithmatex">\(\text{SE}(\hat{\rho})\)</span>.</li>
<li>
<p>Estimate the variance of the residuals <span class="arithmatex">\(\hat{\sigma}^2\)</span>:</p>
<div class="arithmatex">\[
\hat{\sigma^2} = \frac{1}{n - 3} \sum_{t=1}^{n} \hat{r}_{t}^2
\]</div>
<p>where <span class="arithmatex">\(n\)</span> is the number of data points in the sample. We have <span class="arithmatex">\(n-3\)</span> degrees of freedom since there are three parameters in the autoregressive model (<span class="arithmatex">\(\beta_{0}\)</span>, <span class="arithmatex">\(\beta_{1}\)</span>, and <span class="arithmatex">\(\rho\)</span>).</p>
</li>
<li>
<p>Estimate the long-run variance <span class="arithmatex">\(\hat{\lambda}^2\)</span> using a <a href="https://en.wikipedia.org/wiki/Newey%E2%80%93West_estimator">Newey-West</a> style estimator.
This estimator corrects for the additional variability in <span class="arithmatex">\(\epsilon_{t}\)</span> caused by autocorrelation and heteroskedasticity.</p>
<div class="arithmatex">\[
\hat{\lambda}^2 = \hat{\gamma}_{0} + 2\sum_{j=1}^{q} \left(1 - \frac{j}{q + 1} \right)  \gamma_{j}
\]</div>
<p>Each sample autocovariances <span class="arithmatex">\(\gamma_{j}\)</span> above is computed for up to <span class="arithmatex">\(q = \left\lfloor \sqrt[4]{\frac{n}{25}}\right\rfloor\)</span> lags:</p>
<div class="arithmatex">\[
\hat{\gamma}_{j} = \frac{1}{n} \sum_{t = j + 1}^{n} \hat{r}_{t}\hat{r}_{t-j}
\]</div>
</li>
<li>
<p>Compute the test statistic <span class="arithmatex">\(z_{\rho}\)</span> using the following formula:</p>
<div class="arithmatex">\[
z_{\rho } = n(\hat{\rho} - 1) - \frac{n^2 \text{SE}(\hat{\rho})^2}{2 \hat{\sigma}^2}(\hat{\lambda }^2 - \hat{\gamma}_{0})
\]</div>
</li>
</ol>
<p>The test statistic <span class="arithmatex">\(z_{\rho}\)</span> is not normally distributed. Instead, we compute the p-value by interpolating a table from Fuller, W. A. (1996).
This table is shown below for sample sizes <span class="arithmatex">\(n\)</span> and probabilities <span class="arithmatex">\(p\)</span>:</p>
<table>
<thead>
<tr>
<th><span class="arithmatex">\(n\)</span> \ <span class="arithmatex">\(p\)</span></th>
<th>0.01</th>
<th>0.025</th>
<th>0.05</th>
<th>0.10</th>
<th>0.50</th>
<th>0.90</th>
<th>0.95</th>
<th>0.975</th>
<th>0.99</th>
</tr>
</thead>
<tbody>
<tr>
<td>25</td>
<td>-22.5</td>
<td>-20.0</td>
<td>-17.9</td>
<td>-15.6</td>
<td>-8.49</td>
<td>-3.65</td>
<td>-2.51</td>
<td>-1.53</td>
<td>-0.46</td>
</tr>
<tr>
<td>50</td>
<td>-25.8</td>
<td>-22.4</td>
<td>-19.7</td>
<td>-16.8</td>
<td>-8.80</td>
<td>-3.71</td>
<td>-2.60</td>
<td>-1.67</td>
<td>-0.67</td>
</tr>
<tr>
<td>100</td>
<td>-27.4</td>
<td>-23.7</td>
<td>-20.6</td>
<td>-17.5</td>
<td>-8.96</td>
<td>-3.74</td>
<td>-2.63</td>
<td>-1.74</td>
<td>-0.76</td>
</tr>
<tr>
<td>250</td>
<td>-28.5</td>
<td>-24.4</td>
<td>-21.3</td>
<td>-17.9</td>
<td>-9.05</td>
<td>-3.76</td>
<td>-2.65</td>
<td>-1.79</td>
<td>-0.83</td>
</tr>
<tr>
<td>500</td>
<td>-28.9</td>
<td>-24.7</td>
<td>-21.5</td>
<td>-18.1</td>
<td>-9.08</td>
<td>-3.76</td>
<td>-2.66</td>
<td>-1.80</td>
<td>-0.86</td>
</tr>
<tr>
<td>1000</td>
<td>-29.4</td>
<td>-25.0</td>
<td>-21.7</td>
<td>-18.3</td>
<td>-9.11</td>
<td>-3.77</td>
<td>-2.67</td>
<td>-1.81</td>
<td>-0.88</td>
</tr>
</tbody>
</table>
<p><strong>Warning</strong>: The interpolation only works for p-values <span class="arithmatex">\(p &gt; 0.01\)</span> (p-values below <span class="arithmatex">\(0.01\)</span> are truncated) and confidence levels <span class="arithmatex">\(\alpha &gt; 0.01\)</span>.</p>
<hr />
<h2 id="runs-test">Runs Test</h2>
<p>The <strong>Runs Test</strong> checks whether the residuals of a regression (e.g., trend approximation from <a href="#sens-trend-estimator">Sen's estimator</a>) are randomly distributed.
If the Runs test identifies non-randomness in the residuals, it is a strong indication that the nonstationarity in the data is non-linear.</p>
<ul>
<li>Null hypothesis: Residuals are distributed randomly.</li>
<li>Alternative hypothesis: Residuals <em>are not</em> distributed randomly (e.g., due to nonlinearity).</li>
</ul>
<h3 id="steps_3">Steps</h3>
<ol>
<li>Classify the data based on whether it is above (<span class="arithmatex">\(+\)</span>) or below <span class="arithmatex">\((-)\)</span> the median. All data points that are equal to the median are removed.</li>
<li>
<p>Compute the number of contiguous blocks of <span class="arithmatex">\(+\)</span> or <span class="arithmatex">\(-\)</span> (known as <em>runs</em>) in the data. For example, the sequence <span class="arithmatex">\(+++--+++-+-\)</span> has six runs with length <span class="arithmatex">\((3, 2, 3, 1, 1, 1)\)</span>.</p>
</li>
<li>
<p>Let <span class="arithmatex">\(R\)</span> be the number of runs in <span class="arithmatex">\(N\)</span> data points (with category counts <span class="arithmatex">\(N_{+}\)</span> and <span class="arithmatex">\(N_{-}\)</span>). Then, under the null hypothesis, <span class="arithmatex">\(R\)</span> is asymptotically normal with:</p>
<div class="arithmatex">\[
\mathbb{E}[R] = \frac{2N_{+}N_{-}}{N} + 1, \quad
\text{Var}(R) = \frac{2N_{+}N_{-}(2N_{+}N_{-} - N)}{N^2(N - 1)}
\]</div>
</li>
<li>
<p>Compute the p-value by normalizing <span class="arithmatex">\(R\)</span> using the expectation and variance given above.</p>
</li>
</ol>
<h3 id="example-plot_1">Example Plot</h3>
<p><img alt="" src="../img/plot-runs.png" /></p>
<hr />
<h2 id="sens-trend-estimator">Sen's Trend Estimator</h2>
<p><strong>Sen's Trend Estimator</strong> approximates the slope of a regression line.
Unlike <a href="https://en.wikipedia.org/wiki/Least_squares">Least Squares</a>, Sen's trend estimator uses a non-parametric approach which makes it robust to outliers.</p>
<h3 id="steps_4">Steps</h3>
<ol>
<li>
<p>For all pairs <span class="arithmatex">\((x_i, y_i)\)</span> and <span class="arithmatex">\((x_j, y_j)\)</span> where <span class="arithmatex">\(x_i \neq x_j\)</span>, compute slopes:</p>
<div class="arithmatex">\[
m_{ij} = \frac{y_j - y_i}{x_j - x_i}
\]</div>
</li>
<li>
<p>Take the median of all slopes: <span class="arithmatex">\(\hat{m}\)</span>.</p>
</li>
<li>Estimate the <span class="arithmatex">\(y\)</span>-intercept <span class="arithmatex">\(\hat{b}\)</span> as the median of <span class="arithmatex">\(y_{i} - \hat{m}x_{i}\)</span> for all <span class="arithmatex">\(i\)</span>.</li>
</ol>
<h3 id="example-plot_2">Example Plot</h3>
<p><img alt="" src="../img/plot-sens.png" /></p>
<hr />
<h2 id="spearman-test">Spearman Test</h2>
<p>The <strong>Spearman test</strong> identifies autocorrelation in a time series <span class="arithmatex">\(y_{t}\)</span>. 
A <em>significant lag</em> is a number <span class="arithmatex">\(i\)</span> such that the correlation between <span class="arithmatex">\(y_{t}\)</span> and <span class="arithmatex">\(y_{t-i}\)</span> is statistically significant.
The <em>least insignificant lag</em> is the smallest <span class="arithmatex">\(i\)</span> that is <em>not</em> a significant lag.</p>
<ul>
<li>Null hypothesis: The least insignificant lag is <span class="arithmatex">\(1\)</span>.</li>
<li>Alternative hypothesis: The least insignificant lag is greater than <span class="arithmatex">\(1\)</span>.</li>
</ul>
<p>To carry out the Spearman test, we use the following procedure:</p>
<ol>
<li>Compute Spearman's correlation coefficient <span class="arithmatex">\(\rho_{i}\)</span> for <span class="arithmatex">\(y_{t}\)</span> and <span class="arithmatex">\(y_{t-i}\)</span> for all <span class="arithmatex">\(0 \leq  i &lt;  n\)</span>.</li>
<li>Compute the <span class="arithmatex">\(p\)</span>-value <span class="arithmatex">\(p_{i}\)</span> for each correlation coefficient <span class="arithmatex">\(\rho _{i}\)</span> using the formula:
    $$
    t_{i}= \rho_{i} \sqrt{\frac{n-2}{1 - \rho _{i}^2}}
    $$
    The test statistic <span class="arithmatex">\(t_{i}\)</span> has the <span class="arithmatex">\(t\)</span>-distribution with <span class="arithmatex">\(n-2\)</span> degrees of freedom.</li>
<li>Find the smallest <span class="arithmatex">\(i\)</span> such that <span class="arithmatex">\(p_{i} &gt; \alpha\)</span>. Then <span class="arithmatex">\(i\)</span> is the least insignificant lag at confidence level <span class="arithmatex">\(\alpha\)</span>.</li>
</ol>
<p>For more information, see the Wikipedia pages on <a href="https://en.wikipedia.org/wiki/Autocorrelation">Autocorrelation</a> and <a href="https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient">Spearman's Rho</a>.</p>
<h3 id="example-plot_3">Example Plot</h3>
<p><img alt="" src="../img/plot-spearman.png" /></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../eda-change-points/" class="btn btn-neutral float-left" title="Change Points"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../eda-trend-ams-variability/" class="btn btn-neutral float-right" title="Trends in AMS Variability">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../eda-change-points/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../eda-trend-ams-variability/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-chtml-full.min.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
